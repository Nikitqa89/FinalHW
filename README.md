# üß† GPT-–ë–æ—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∏—Ö–æ–≤

–ù–µ–π—Ä–æ—Å–µ—Ç—å, –æ–±—É—á–µ–Ω–Ω–∞—è –ø–∏—Å–∞—Ç—å –ø–æ—ç–∑–∏—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.  
–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPT-like —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –∏ Telegram-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ `aiogram`.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ bot.py                    # Telegram-–±–æ—Ç (aiogram 3)
‚îú‚îÄ‚îÄ config.py                 # –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ data.txt                  # –°—ã—Ä–æ–π –∫–æ—Ä–ø—É—Å
‚îú‚îÄ‚îÄ filtered_poetry_lines.txt # –û—á–∏—â–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
‚îú‚îÄ‚îÄ generate.py               # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
‚îú‚îÄ‚îÄ model.py                  # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ GPT
‚îú‚îÄ‚îÄ preprocess.py             # –û—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
‚îú‚îÄ‚îÄ tokenizer.py              # –°–ª–æ–≤–∞—Ä—å –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ train.py                  # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ models/                   # –ö–∞—Ç–∞–ª–æ–≥ —Å –≤–µ—Å–∞–º–∏ –º–æ–¥–µ–ª–∏
‚îî‚îÄ‚îÄ .env                      # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Telegram —Ç–æ–∫–µ–Ω)
```

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install -r requirements.txt
```

–°–æ–∑–¥–∞–π—Ç–µ `.env`:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
```

---

## ‚öôÔ∏è –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
python preprocess.py
```

–§–∞–π–ª `filtered_poetry_lines.txt` –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª (–¥–ª–∏–Ω–∞, —Å–∏–º–≤–æ–ª—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∞—Ç–∏–Ω–∏—Ü—ã –∏ –ø—Ä.).

---

## üß† –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python train.py
```

–°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤–µ—Å–∞:  
- `models/model.pth` ‚Äî –ø–æ—Å–ª–µ–¥–Ω—è—è  
- `models/best_model.pth` ‚Äî —Å –ª—É—á—à–∏–º `val loss`  
- `loss_plot.png` ‚Äî –≥—Ä–∞—Ñ–∏–∫ –ø–æ—Ç–µ—Ä—å

---

## ‚ú® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è

```python
from generate import generate_text, generate_batch

generate_text(
    prompt="–¢—ã –∏–¥–µ—à—å",
    temperature=0.9,
    top_k=10,
    max_new_tokens=100,
    eos_token="\n"
)

# –ü–∞–∫–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
generate_batch([
    "–¢—ã –∏–¥–µ—à—å –ø–æ –¥–æ—Ä–æ–≥–µ",
    "–ù–µ–±–æ —Ä–æ–Ω—è–µ—Ç —Å–ª–µ–∑—ã",
    "–û—Å–µ–Ω—å –≤ —Å–µ—Ä–¥—Ü–µ"
], temperature=0.9, top_k=10)
```

---

## ü§ñ Telegram-–±–æ—Ç

–ó–∞–ø—É—Å–∫:

```bash
python bot.py
```

---

## üì≤ –ö–æ–º–∞–Ω–¥—ã –≤ Telegram

| –ö–æ–º–∞–Ω–¥–∞      | –û–ø–∏—Å–∞–Ω–∏–µ                                                       |
|--------------|----------------------------------------------------------------|
| `/start`     | –ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º                                         |
| `/help`      | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É                                               |
| `/set`       | –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`temperature`, `top_k`, `max_new_tokens`) |
| `/params`    | –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã                                     |
| `/stanza`    | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω—É —Å—Ç—Ä–æ—Ñ—É (–¥–æ —Å–∏–º–≤–æ–ª–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)           |
| `/batch`     | –ü–∞–∫–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π prompt          |

---

## üìí –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –±–æ—Ç–µ

- `/set temperature=1.0 top_k=15`
- `/batch\n–¢—ã –∏–¥–µ—à—å\n–õ–∏—Å—Ç—å—è –ø–∞–¥–∞—é—Ç\n–û—Å–µ–Ω—å —Ä—è–¥–æ–º`

---

## üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å (~70 —Å–∏–º–≤–æ–ª–æ–≤)
- –ê–≤—Ç–æ–æ–±—Ä–µ–∑–∫–∞ –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`block_size = 256`)
- `eos_token='\n'` –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–æ —Å—Ç—Ä–æ—Ñ–µ
- –ü–µ—á–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏: —á–µ—Ä–µ–∑ `on_token`
- –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `generation.log`

---

## üõ† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- PyTorch
- aiogram 3.x

---
